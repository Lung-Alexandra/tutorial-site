# Animatie - Dreptunghi cu satelit - OpenGL << vechi >>

**_03_01_animatie_OLD.cpp_**

Program ce deseneaza un dreptunghi ce se deplaseaza stanga-dreapta si are un patrat 
ce orbiteaza in jurul sau, folosindu-se tehnicile OLD OpenGL;

ELEMENTE DE NOUTATE:
- gluOrtho2D (indica dreptunghiul care este decupat) - DEPRECATED
- glTranslate, glRotate, glPushMatrix, glPopMatrix (pentru transformari; DEPRECATED)
- glutSwapBuffers (v. GLUT_DOUBLE); glutPostRedisplay; glutIdleFunc (animatie)

## 1. gluOrtho2D - deprectated
Este modalitatea veche de a crea o matrice de proiectie ortogonala, al carei efect este 
decuparea ecranului.

Practic, definim limitele dreptunghiului ce urmeaza sa fie decupat
```cpp
    GLfloat xMin = 0, yMin = 0, xMax = 800.0, yMax = 600.0;
```
si apelam functia **gluOrtho2D**
```cpp
    gluOrtho2D(xMin, xMax, yMin, yMax);			
```

## 2. IdleFunction
Cu ajutorul functiei ```glutIdleFunc```, putem seta o functie care va fi apelata
continuu in timpul randarii. Este folositoare cand vrem sa cream animatii.

```cpp
	glutIdleFunc(IdleFunction);
```

Functia nostra va actualiza pozitia si rotatia dreptunghiurilor. 
In cazul in care obiectele ajung la margine, directia animatiei se schimba.
```cpp
void IdleFunction()
{
	position = position + alpha;
	angle = angle + 0.1;	
	if (position < xMin + 20)	
		alpha = 0.1;		
	else if (position > xMax - 20)
		alpha = -0.1;	
	glutPostRedisplay();
}
```
- **position**: reprezeinta pozitia dreptunghiului principal pe axa orizontala
- **angle**: reprezinta unghiul de rotatie al obiectului care orbiteaza in jurul dreptunghiului principal
- **alpha**: valoare folosita pentru a asigura miscarea stanga/dreapta
- **glutPostRedisplay()**: redeseneaza scena
## 3. Functia de randare - deprecated

```cpp
void RenderFunction()
{
	glClear(GL_COLOR_BUFFER_BIT);
			
	glPushMatrix();
	glTranslated(position, 200.0, 0.0);	
	glPushMatrix();
	glRotated(angle, 0.0, 0.0, 1.0);
	glColor3f(1.0, 0.0, 0.0);
	glRecti(-5, 30, 5, 40);		
	glPopMatrix();
	glPopMatrix();
	
	glPushMatrix();
	glTranslated (position, 200.0, 0.0);
	glColor3f(0.0, 0.0, 1.0);
	glRecti(-20, -12, 20, 12);		
	glPopMatrix();
	
	glutSwapBuffers();
	glFlush();			
}
```
- **glPushMatrix()**: duplica matricea model care se afla in varful stivei de matrici
- **glPopMatrix()**: elimina matricea din varful stivei de matrici
- **glTranslated()**: inmulteste o matrice de translatie cu matricea din varful stivei de matrici
- **glRotated()**: inmulteste o matrice de rotatie cu matricea din varful stivei de matrici
- **glRecti()**: deseneaza un dreptunghi

Primul bloc de cod are rolul de a aplica o translatie si o rotatie si a desena obiectul 
care orbiteaza. Al doilea bloc de cod aplica o translatie si deseneaza dreptunghiul 
principal.

### glutSwapBuffers()
Este o metoda care schimba intre ele cele doua buffere ale ferestrei si ajuta la
randarea mai fluida a animatiilor.

Fereastra trebuie sa fie initializata cu **GLUT_DOUBLE**:
```cpp
glutInitDisplayMode(GLUT_DOUBLE | GLUT_RGB);	
```

Pentru a semnala redesenarea scenei, se foloseste:
```cpp
glutPostRedisplay();
```
In programul nostru se gaseste in **IdleFunc()**